work_dir: ./work_dir/SHREC/bone

stream: bone

model: net.dsa_hgn.Model
model_args:
  in_channels: 8
  base_channels: 64
  num_class: 14
  num_person: 1

  graph: graph.shrec_line.Graph
  graph_args:
    labeling_mode: 'spatial'
  num_point: 21

  # âœ… ä¿®å¤ 1: å¢åŠ åŠ¨æ€è¶…è¾¹æ•°é‡,è¡¥å¿ç‰©ç†è¾¹å¸¦æ¥çš„è¡¨è¾¾èƒ½åŠ›æŸå¤±
  num_hyperedges: 12       # 12 åŠ¨æ€ + 5 ç‰©ç† = 17 æ€»è¾¹ (è¶…è¿‡åŸå§‹ 16)
  k_neighbors: 4
  adaptive: true
  use_virtual_conn: True

  num_stages: 10
  inflate_stages: [5, 8]
  down_stages: [5, 8]
  data_bn_type: 'VC'
  drop_out: 0.3

train_feeder: feeder.feeder_hgt.Feeder
test_feeder: feeder.feeder_hgt.Feeder

train_feeder_args:
  data_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/train_data.npy
  label_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/train_label.pkl
  split: train
  random_choose: True
  random_rot: True
  repeat: 5
  normalization: False
  window_size: 180
  debug: False
  use_mmap: True
  use_sg: True
  sg_window: 9
  sg_order: 2
  use_angles: True
  use_rotations: True

test_feeder_args:
  data_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/val_data.npy
  label_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/val_label.pkl
  split: test
  debug: False
  use_mmap: True
  normalization: False
  window_size: 180

  use_sg: True
  sg_window: 9
  sg_order: 2
  use_angles: True
  use_rotations: True

# ===================================================================
# ğŸ”§ ä¿®å¤æ–¹æ¡ˆ 3: å¹³è¡¡æ­£åˆ™åŒ–æƒé‡
# ===================================================================

optimizer: SGD
base_lr: 0.05
weight_decay: 0.0005
nesterov: True
grad_clip_norm: 1.0

lr_decay_rate: 0.1
step: [30, 50]
warm_up_epoch: 5
num_epoch: 80

device: [0]
batch_size: 32
test_batch_size: 32
num_worker: 4

loss: torch.nn.CrossEntropyLoss

lambda_entropy: 0.005    # å¢åŠ ç†µæƒé‡,å‹åˆ¶å‡åŒ€åˆ†å¸ƒ (0.001 â†’ 0.005)
lambda_ortho: 0.05       # å‡å°æ­£äº¤çº¦æŸ,å¢åŠ çµæ´»æ€§ (0.1 â†’ 0.05)
lambda_physical: 0.1    # â­ å¯ç”¨ç‰©ç†çº¦æŸ! (0.0 â†’ 0.05)

log_interval: 100
save_interval: 1
eval_interval: 1

# ===================================================================
# ğŸ“ ä¿®å¤ç†è®ºä¾æ®
# ===================================================================
#
# 1. è¶…è¾¹æ•°é‡è°ƒæ•´ (8 â†’ 12):
#    - åŸå§‹çº¯åŠ¨æ€: 16 ä¸ªè¶…è¾¹
#    - å½“å‰æ··åˆ: 12 åŠ¨æ€ + 5 ç‰©ç† = 17 æ€»è¾¹
#    - å¢ç›Š: ä¿æŒè¡¨è¾¾èƒ½åŠ› + æ³¨å…¥å…ˆéªŒçŸ¥è¯†
#
# 2. ç‰©ç†çº¦æŸæƒé‡ (0.0 â†’ 0.05):
#    - ç¡®ä¿åŠ¨æ€è¾¹ä¸ç‰©ç†è¾¹æ­£äº¤
#    - é¿å…é‡å¤å»ºæ¨¡ç›¸åŒçš„æ‰‹æŒ‡å†…è¿æ¥
#    - æƒé‡ä¸ lambda_ortho ç›¸åŒé‡çº§,ä¿æŒå¹³è¡¡
#
# 3. ç†µæ­£åˆ™åŒ–å¢å¼º (0.001 â†’ 0.005):
#    - ç›®æ ‡: å°†ç†µä» 2.07 é™ä½åˆ° 1.5-1.8
#    - ä¿ƒä½¿æ¯ä¸ªèŠ‚ç‚¹åªè¿æ¥ 2-3 ä¸ªè¶…è¾¹ (ç¨€ç–æ€§)
#    - æå‡å¯è§£é‡Šæ€§å’Œæ³›åŒ–èƒ½åŠ›
#
# 4. æ­£äº¤çº¦æŸæ”¾æ¾ (0.1 â†’ 0.05):
#    - å…è®¸åŸå‹å‘é‡æœ‰è½»å¾®ç›¸å…³æ€§
#    - å¢åŠ åŠ¨æ€è¶…è¾¹çš„è¡¨è¾¾è‡ªç”±åº¦
#    - é¿å…è¿‡åº¦é™åˆ¶ç‰¹å¾å­¦ä¹ 
#
# ===================================================================
# ğŸ¯ é¢„æœŸæ•ˆæœ
# ===================================================================
#
# ä¿å®ˆä¼°è®¡: 86-88% (æ¢å¤åˆ°åŸå§‹æ°´å¹³)
# ç†æƒ³æƒ…å†µ: 90-92% (ç‰©ç†å…ˆéªŒå¸¦æ¥æå‡)
#
# éªŒè¯æ–¹æ³•:
#   1. è§‚å¯Ÿ loss_phy æ˜¯å¦ä» 0.19 ä¸‹é™åˆ° 0.05-0.10
#   2. è§‚å¯Ÿ loss_ent æ˜¯å¦ä» 2.07 ä¸‹é™åˆ° 1.5-1.8
#   3. æ£€æŸ¥éªŒè¯é›†å‡†ç¡®ç‡æ˜¯å¦åœ¨ Epoch 30 è¶…è¿‡ 85%
# ===================================================================