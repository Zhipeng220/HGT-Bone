# 1. åŸºç¡€è®¾ç½®
work_dir: ./work_dir/SHREC/joint_finetune  # âš ï¸ ä¿®æ”¹ç›®å½•ï¼Œä¿ç•™åŸæ—¥å¿—
stream: joint

# 2. å…³é”®ï¼šåŠ è½½æœ€ä½³æƒé‡
# è¯·ç¡®ä¿è·¯å¾„ä¸æ‚¨æœ¬åœ°å®é™…è·¯å¾„ä¸€è‡´
weights: ./work_dir/SHREC/joint/epoch015_acc92.74_model.pt

# 3. è®­ç»ƒå‚æ•°è°ƒæ•´ (å¾®è°ƒæ¨¡å¼)
phase: train
start_epoch: 16         # é‡æ–°å¼€å§‹è®¡æ•°ï¼Œæ–¹ä¾¿è®¾ç½® LR schedule
num_epoch: 50          # åªéœ€è¦å°‘é‡è½®æ¬¡å³å¯æ”¶æ•›
base_lr: 0.005         # ğŸ”´ é™ä¸ºåŸæ¥çš„ 1/10 (0.05 -> 0.005)
step: [25, 40]         # åœ¨ç¬¬ 15 å’Œ 30 è½®è¿›ä¸€æ­¥è¡°å‡
warm_up_epoch: 0       # å¾®è°ƒä¸éœ€è¦é¢„çƒ­

# 4. æ­£åˆ™åŒ–å¢å¼º (é˜²æ­¢è¿‡æ‹Ÿåˆ)
lambda_entropy: 0.02   # ğŸ”´ å¢å¤§æƒé‡ (0.001 -> 0.02)ï¼Œå¼ºè¿«è¶…å›¾ç¨€ç–åŒ–
lambda_ortho: 0.1      # ä¿æŒä¸å˜

# 5. æ¨¡å‹å®šä¹‰ (å¿…é¡»ä¸åŸé…ç½®å®Œå…¨ä¸€è‡´)
model: net.dsa_hgn.Model
model_args:
  in_channels: 3
  base_channels: 64
  ch_ratio: 2
  num_stages: 10
  inflate_stages: [5, 8]
  down_stages: [5, 8]
  data_bn_type: 'VC'
  num_person: 1
  pretrained: None
  num_class: 14
  num_point: 22
  drop_out: 0.0
  graph: graph.shrec.Graph
  graph_args:
    labeling_mode: 'spatial'
  num_hyperedges: 16
  k_neighbors: 4
  adaptive: true
  use_virtual_conn: True

# 6. æ•°æ®åŠ è½½ (ä¿æŒä¸€è‡´)
train_feeder: feeder.feeder_egogesture.Feeder
test_feeder: feeder.feeder_egogesture.Feeder
train_feeder_args:
  data_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/train_data.npy
  label_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/train_label.pkl
  split: train
  bone: False
  vel: False
  window_size: 180
  normalization: False
  random_choose: True
  random_move: False
  random_shift: True
  repeat: 5
  debug: False
  use_mmap: True
test_feeder_args:
  data_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/val_data.npy
  label_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/val_label.pkl
  split: test
  bone: False
  vel: False
  window_size: 180
  normalization: False
  debug: False
  use_mmap: True

# 7. ä¼˜åŒ–å™¨
optimizer: SGD
weight_decay: 0.0005
nesterov: True
grad_clip_norm: 1.0
lr_decay_rate: 0.1
device: [0]
batch_size: 32
test_batch_size: 32
num_worker: 4
loss: torch.nn.CrossEntropyLoss
log_interval: 100
save_interval: 1
eval_interval: 1       # å¾®è°ƒæ—¶æ¯è½®éƒ½éªŒè¯ï¼Œä»¥å…é”™è¿‡å³°å€¼