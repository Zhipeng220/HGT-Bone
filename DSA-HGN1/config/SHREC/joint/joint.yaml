# work_dir: ./work_dir/SHREC/hyperhand_joint_final_optimized
# å»ºè®®ä¿®æ”¹å·¥ä½œç›®å½•ä»¥åŒºåˆ†

# 1. è®­ç»ƒæµè®¾ç½®
stream: joint

# 2. æ¨¡å‹å®šä¹‰ (ä¿æŒä¸€è‡´)
model: net.dsa_hgn.Model
model_args:
  in_channels: 3
  base_channels: 64
  ch_ratio: 2
  num_stages: 10
  inflate_stages: [5, 8]
  down_stages: [5, 8]
  data_bn_type: 'VC'
  num_person: 1
  pretrained: None
  num_class: 14
  num_point: 22
  drop_out: 0.0
  graph: graph.shrec.Graph
  graph_args:
    labeling_mode: 'spatial'
  num_hyperedges: 16
  k_neighbors: 4
  adaptive: true
  use_virtual_conn: True

# 3. æ•°æ®åŠ è½½
train_feeder: feeder.feeder_egogesture.Feeder
test_feeder: feeder.feeder_egogesture.Feeder

train_feeder_args:
  data_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/train_data.npy
  label_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/train_label.pkl
  split: train
  # ğŸ”´ Joint æµæ ¸å¿ƒè®¾ç½®
  bone: False          # å…³é—­ Bone
  vel: False           # å…³é—­ Velocity

  window_size: 180
  normalization: False # ä¿æŒä¸ Bone æµä¸€è‡´
  random_choose: True
  random_move: False
  random_shift: True
  repeat: 5
  debug: False
  use_mmap: True

test_feeder_args:
  data_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/val_data.npy
  label_path: /Users/gzp/Desktop/exp/DATA/SHREC2017_data/val_label.pkl
  split: test
  # ğŸ”´ ä¿æŒä¸€è‡´
  bone: False
  vel: False

  window_size: 180
  normalization: False
  debug: False
  use_mmap: True

# 4. ä¼˜åŒ–å™¨ (å…³é”®ç­–ç•¥ï¼šå¤ç”¨ Bone æµçš„ SGD)
optimizer: SGD
base_lr: 0.05          # ä¿æŒä¸ Bone æµä¸€è‡´çš„é«˜å­¦ä¹ ç‡
weight_decay: 0.0005   # ä¿æŒä¸€è‡´
nesterov: True
grad_clip_norm: 1.0

# å­¦ä¹ ç‡è°ƒåº¦ (å…³é”®ç­–ç•¥ï¼šæ¿€è¿›è¡°å‡)
lr_decay_rate: 0.1
step: [30, 50]         # å¤ç”¨æ—¥å¿—ä¸­éªŒè¯æœ‰æ•ˆçš„è¡°å‡ç‚¹
warm_up_epoch: 5
num_epoch: 60         # ä¿æŒ 150 è½®

# 5. ç¡¬ä»¶ä¸ Batch
device: [0]
batch_size: 32
test_batch_size: 32
num_worker: 4

# 6. æŸå¤±å‡½æ•°
loss: torch.nn.CrossEntropyLoss

# 7. æ­£åˆ™åŒ–å‚æ•°
lambda_entropy: 0.001
lambda_ortho: 0.1

log_interval: 100
save_interval: 1
eval_interval: 5